<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Pro Notes Ultimate Fix</title>

<style>
:root {
    --bg:#f2f2f7;--card:#fff;--text:#000;
    --accent:#007aff;--orange:#ff9500;--red:#ff3b30;
    --sheet-bg:rgba(245,245,247,.98);
    --btn-grey:#e5e5ea;--btn-text:#000;
    --border:#c6c6c8;--blur:blur(20px);
}
[data-theme="dark"] {
    --bg:#000;--card:#1c1c1e;--text:#fff;
    --sheet-bg:rgba(30,30,30,.98);
    --btn-grey:#3a3a3c;--btn-text:#fff;
    --border:#38383a;
}
*{box-sizing:border-box;-webkit-tap-highlight-color:transparent}
body{
    margin:0;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text",sans-serif;
    background:var(--bg);color:var(--text);height:100vh;overflow:hidden;
    display:flex;flex-direction:column
}
.editor-area{flex:1;padding:20px 20px 120px}
#titleInput{border:none;font-size:2.2rem;font-weight:700;background:none;color:var(--text);outline:none}
#noteBody{flex:1;border:none;background:none;font-size:1.2rem;color:var(--text);outline:none;resize:none}

/* DOCK */
.dock-bar{
    position:fixed;bottom:30px;left:15px;right:15px;
    background:var(--sheet-bg);backdrop-filter:var(--blur);
    padding:8px;border-radius:45px;
    display:flex;justify-content:space-between;
    box-shadow:0 10px 30px rgba(0,0,0,.25);
    z-index:9000
}
.dock-btn{
    width:50px;height:50px;border-radius:50%;
    border:none;background:none;font-size:1.5rem;
    color:var(--accent)
}
.dock-btn.main-action{background:var(--accent);color:#fff}

/* OVERLAYS */
.overlay{
    position:fixed;inset:0;background:rgba(0,0,0,.5);
    display:flex;justify-content:flex-end;
    opacity:0;pointer-events:none;
    transition:.3s;z-index:10000
}
.overlay.active{opacity:1;pointer-events:auto}
.sheet{
    background:var(--sheet-bg);
    width:100%;border-radius:30px 30px 0 0;
    transform:translateY(100%);
    transition:.35s cubic-bezier(.2,.9,.3,1);
    max-height:90vh;overflow:hidden
}
.overlay.active .sheet{transform:none}
.handle-area{padding:15px;display:flex;justify-content:center}
.handle-bar{width:40px;height:5px;background:var(--border);border-radius:10px}

/* CALC */
.calc-container{padding:0 20px 40px}
#calcResult{
    font-size:3.5rem;border:none;background:none;
    color:var(--text);width:100%;text-align:right
}
.keypad{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
.key-btn{
    aspect-ratio:1;border:none;border-radius:50%;
    font-size:1.5rem;background:var(--btn-grey)
}
.key-btn.orange{background:var(--orange);color:#fff}
.key-btn.wide{grid-column:span 2;border-radius:40px}

/* LIST */
.list-container{padding:20px;height:70vh;overflow:auto}
.note-card{
    background:var(--card);padding:15px;border-radius:12px;
    margin-bottom:10px;display:flex;justify-content:space-between
}
</style>
</head>

<body data-theme="light">

<div class="editor-area">
    <input id="titleInput" placeholder="TÃ­tulo">
    <textarea id="noteBody" placeholder="Escreve aqui..."></textarea>
</div>

<div class="dock-bar">
    <button id="btnTheme" class="dock-btn">â—‘</button>
    <button id="btnList" class="dock-btn">â˜°</button>
    <button id="btnOpenCalc" class="dock-btn main-action">ðŸ§®</button>
    <button id="btnOpenConv" class="dock-btn">â‡„</button>
    <button id="btnSave" class="dock-btn">ðŸ’¾</button>
</div>

<!-- CALC -->
<div id="modalCalc" class="overlay">
<div class="sheet">
<div class="handle-area"><div class="handle-bar"></div></div>
<div class="calc-container">
<input id="calcResult" value="0" readonly>
<div class="keypad">
<button class="key-btn" onclick="cls()">AC</button>
<button class="key-btn" onclick="del()">âŒ«</button>
<button class="key-btn" onclick="ins('%')">%</button>
<button class="key-btn orange" onclick="ins('/')">Ã·</button>
<button class="key-btn" onclick="ins('7')">7</button>
<button class="key-btn" onclick="ins('8')">8</button>
<button class="key-btn" onclick="ins('9')">9</button>
<button class="key-btn orange" onclick="ins('*')">Ã—</button>
<button class="key-btn" onclick="ins('4')">4</button>
<button class="key-btn" onclick="ins('5')">5</button>
<button class="key-btn" onclick="ins('6')">6</button>
<button class="key-btn orange" onclick="ins('-')">âˆ’</button>
<button class="key-btn" onclick="ins('1')">1</button>
<button class="key-btn" onclick="ins('2')">2</button>
<button class="key-btn" onclick="ins('3')">3</button>
<button class="key-btn orange" onclick="ins('+')">+</button>
<button class="key-btn wide" onclick="ins('0')">0</button>
<button class="key-btn" onclick="ins('.')">.</button>
<button class="key-btn orange" onclick="calculate()">=</button>
</div>
</div>
</div>
</div>

<!-- LIST -->
<div id="modalList" class="overlay">
<div class="sheet">
<div class="handle-area"><div class="handle-bar"></div></div>
<div class="list-container">
<h2>Notas</h2>
<div id="notesContainer"></div>
</div>
</div>
</div>

<script>
const $=id=>document.getElementById(id);
let notes=JSON.parse(localStorage.getItem("notes")||"[]");

function openModal(id){$(id).classList.add("active")}
function closeModal(id){$(id).classList.remove("active")}

btnTheme.onclick=()=>document.body.dataset.theme=
document.body.dataset.theme==="light"?"dark":"light";

btnOpenCalc.onclick=()=>openModal("modalCalc");
btnList.onclick=()=>openModal("modalList");

btnSave.onclick=()=>{
    if(!noteBody.value.trim())return alert("Nota vazia");
    notes.unshift({t:titleInput.value||"Sem tÃ­tulo",b:noteBody.value});
    localStorage.setItem("notes",JSON.stringify(notes));
    alert("Guardado");
};

function renderNotes(){
    notesContainer.innerHTML=notes.map(n=>`
        <div class="note-card">
            <div>${n.t}</div>
        </div>`).join("");
}
btnList.onclick=()=>{renderNotes();openModal("modalList")};

let display=calcResult;
window.ins=v=>display.value=display.value==="0"?v:display.value+v;
window.cls=()=>display.value="0";
window.del=()=>display.value=display.value.length>1?display.value.slice(0,-1):"0";
window.calculate=()=>{
    try{
        let r=eval(display.value.replace(/Ã—/g,"*").replace(/Ã·/g,"/"));
        display.value=+r.toFixed(6)
    }catch{display.value="Erro"}
};

document.querySelectorAll(".overlay").forEach(o=>{
    o.onclick=e=>{if(e.target===o)closeModal(o.id)}
});
</script>
</body>
</html>
