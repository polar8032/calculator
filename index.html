<!DOCTYPE html>
<html lang="pt">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pro Notes iOS</title>

<style>
:root{
--bg:#f2f2f7;--sheet:#fff;--text:#111;
--accent:#007aff;--orange:#ff9500;
--border:#d1d1d6;--grey:#e5e5ea;
--blur:blur(12px);
}
[data-theme="dark"]{
--bg:#000;--sheet:#1c1c1e;--text:#fff;
--grey:#2c2c2e;--border:#3a3a3c;
}
*{box-sizing:border-box;font-family:-apple-system,BlinkMacSystemFont}
body{margin:0;background:var(--bg);color:var(--text);height:100vh;overflow:hidden}

/* Notes */
.section-notes{height:100vh;padding:16px;display:flex;flex-direction:column}
textarea,input{border:none;background:none;color:var(--text);outline:none}
textarea{flex:1;font-size:1.05rem}

/* Bottom Bar */
.floating-actions{
position:fixed;bottom:0;left:0;right:0;
display:flex;justify-content:space-around;
padding:10px;background:var(--sheet);
border-top:1px solid var(--border)
}
.btn-mini{width:48px;height:48px;border-radius:50%;border:none;
background:var(--accent);color:#fff;font-size:1.2rem}

/* Calculator Modal */
.calc-modal{
position:fixed;inset:0;background:rgba(0,0,0,.35);
backdrop-filter:var(--blur);
display:flex;align-items:flex-end;
opacity:0;pointer-events:none;
transition:.3s;
}
.calc-modal.show{opacity:1;pointer-events:auto}

.calc-sheet{
width:100%;background:var(--sheet);
border-radius:20px 20px 0 0;
padding:12px;
transform:translateY(100%);
transition:transform .35s cubic-bezier(.22,.61,.36,1);
}
.calc-modal.show .calc-sheet{transform:translateY(0)}

.calc-header{display:flex;justify-content:space-between;align-items:center}
#calc-display{width:100%;height:60px;font-size:2rem;text-align:right}

.grid{display:grid;grid-template-columns:repeat(4,1fr);gap:8px}
.grid button{
height:56px;border-radius:50%;
border:none;background:var(--grey);font-size:1.1rem
}
.op{color:var(--accent)}
.orange{background:var(--orange);color:#fff}
.wide{grid-column:span 2;border-radius:28px;background:var(--accent);color:#fff}

/* History */
.history{
max-height:0;overflow:hidden;
transition:max-height .3s ease;
}
.history.show{max-height:160px}
.history div{
padding:6px;font-size:.95rem;
border-bottom:1px solid var(--border);
cursor:pointer
}
</style>
</head>

<body data-theme="light">

<div class="section-notes">
<input placeholder="TÃ­tulo">
<textarea id="notes" placeholder="Escreve..."></textarea>
</div>

<div class="floating-actions">
<button id="dark">ðŸŒ™</button>
<button id="openCalc">ðŸ§®</button>
</div>

<div class="calc-modal" id="modal">
<div class="calc-sheet" id="sheet">

<div class="calc-header">
<strong>Calculadora</strong>
<div>
<button id="historyBtn">ðŸ•˜</button>
<button id="close">âœ•</button>
</div>
</div>

<input id="calc-display" readonly>

<div class="history" id="history"></div>

<div class="grid" id="grid"></div>

<button id="send" class="wide">Enviar para Notas</button>

</div>
</div>

<script>
const modal=document.getElementById("modal");
const sheet=document.getElementById("sheet");
const display=document.getElementById("calc-display");
const grid=document.getElementById("grid");
const notes=document.getElementById("notes");
const historyBox=document.getElementById("history");

let history=[];

const buttons=[
"C","âŒ«","%","Ã·",
"7","8","9","Ã—",
"4","5","6","-",
"1","2","3","+",
"0",".","="
];

function render(){
grid.innerHTML="";
buttons.forEach(b=>{
const btn=document.createElement("button");
btn.textContent=b;
if("+-Ã—=Ã·".includes(b))btn.classList.add("orange");
if(["C","âŒ«","%"].includes(b))btn.classList.add("op");
if(b==="0")btn.classList.add("wide");
btn.onclick=()=>press(b);
grid.appendChild(btn);
});
}

function press(v){
if(v==="C"){display.value="";return;}
if(v==="âŒ«"){display.value=display.value.slice(0,-1);return;}
if(v==="="){
try{
const exp=display.value.replace(/Ã—/g,"*").replace(/Ã·/g,"/");
const res=eval(exp);
history.unshift(`${display.value} = ${res}`);
updateHistory();
display.value=res;
}catch{display.value="Erro"}
return;
}
display.value+=v;
}

function updateHistory(){
historyBox.innerHTML="";
history.slice(0,5).forEach(h=>{
const d=document.createElement("div");
d.textContent=h;
d.onclick=()=>display.value=h.split("=")[1].trim();
historyBox.appendChild(d);
});
}

document.getElementById("openCalc").onclick=()=>modal.classList.add("show");
document.getElementById("close").onclick=()=>modal.classList.remove("show");
document.getElementById("historyBtn").onclick=()=>historyBox.classList.toggle("show");
document.getElementById("send").onclick=()=>{
if(display.value)notes.value+=`â€¢ ${display.value}\n`;
};

/* Swipe gestures */
let startY=0,startX=0;
sheet.addEventListener("touchstart",e=>{
startY=e.touches[0].clientY;
startX=e.touches[0].clientX;
});
sheet.addEventListener("touchend",e=>{
const dy=e.changedTouches[0].clientY-startY;
const dx=e.changedTouches[0].clientX-startX;
if(dy>80)modal.classList.remove("show");
if(dy<-80)historyBox.classList.add("show");
if(dx>80)display.value="";
});

/* Dark mode */
document.getElementById("dark").onclick=()=>{
document.body.dataset.theme=
document.body.dataset.theme==="dark"?"light":"dark";
};

render();
</script>

</body>
</html>
